# Configuration for the Moriond 2016 resonant di-Higgs analysis
# Creator: Andrew Hard
# Email: ahard@cern.ch
# Date: 01/14/2016

################################################################################
# Global analysis settings:

JobName:		January25

Verbose: 		YES

DoBlind: 		YES

# Luminosity in pb-1:
AnalysisLuminosity: 	3200

HiggsMass: 		125.09

# Either Resonant or NonResonant:
AnalysisType: 		NonResonant

# Single Higgs production mode information:
SigSHModes: 		ggH VBF WH ZH ttH

################################################################################
# Plot settings:

ATLASLabel:		Simulation Internal

################################################################################
# Settings for various steps of the analysis:

#Workspace Jobs:
WorkspaceOptions:      New

# Toy MC Jobs:
PseudoExpOptions:      FixMu
toySeed: 	       9865
nToysTotal: 	       500
nToysPerJob: 	       100

# CL and p0 Calculation Jobs:
TestStatOptions:       New
MuLimitOptions:	       null

################################################################################
# STATISTICAL MODEL:

UseSystematics:		YES

# Number of bins in the Asimov data (more = more refined):
NBinsAsimov: 	    	1000

##### Categorization information:

# Make Sure control region(s) always first, for fit to create Asimov data:
CateNames:		jj bj bb
PrintCateName_jj: 	0 b-tagged category
PrintCateName_bj: 	1 b-tagged category
PrintCateName_bb: 	2 b-tagged category

# Types of expectation terms to add:
#ExpectationTypes: 	res scale yield

Model_PoI:		mu_SigBSM2H[1.0,0.0,1000.0]

# List systematic sources (uncorrelated systematics should be listed individually (e.g. bias):
#SysSources:		lumi isEM ERes EScale Migr BkgMod_bb
SysSources:		lumi isEM ERes EScale BkgMod_bb GGFTh VBFTh VHTh TTHTh GGPdf QQPdf BRyy

# Systematics:
SysForm_lumi:		lumi[constr=logn,center=1.0,type=yield,comp=Common~0.028]
SysForm_isEM: 		isEM[constr=logn,center=1.0,type=yield,comp=Common~0.015]
SysForm_ERes: 		ERes[constr=gaus,center=1.0,type=res,comp=SigSM_bb~0.13,comp=SigBSM2H_bb~0.10]
SysForm_EScale: 	EScale[constr=gaus,center=1.0,type=scale,comp=SigSM_bb~0.004,comp=SigBSM2H_bb~0.004]

# SM Higgs Theory systematics:
SysForm_GGFTh:		GGFTh[constr=asym,center=1.0,type=yield,comp=SigSMggH~0.078,compLo=SigSMggH~0.085]#
SysForm_VBFTh:		VBFTh[constr=asym,center=1.0,type=yield,comp=SigSMVBF~0.002]
SysForm_VHTh:		VHTh[constr=asym,center=1.0,type=yield,comp=SigSMWH~0.01,comp=SigSMZH~0.031]	
SysForm_TTHTh:		TTHTh[constr=asym,center=1.0,type=yield,comp=SigSMttH~0.078,compLo=SigSMttH~0.227]
SysForm_GGPdf:		GGPdf[constr=asym,center=1.0,type=yield,comp=SigSMggH~0.069,compLo=SigSMggH~0.063,comp=SigSMttH~0.025]
SysForm_QQPdf:		QQPdf[constr=asym,center=1.0,type=yield,comp=SigSMVBF~0.081,comp=SigSMWH~0.028,comp=SigSMWH~0.030,comp=SigSMZH~0.023]
# Branching ratio to yy:
SysForm_BRyy: 		BRyy[constr=gaus,center=1.0,type=yield,comp=Common~0.049]

# Spurious signal (size should be events per fb-1):
SysForm_BkgMod_bb:	BkgMod_bb[constr=gaus,center=0.0,type=yield,comp=Bias_bb~0.01]

# Migration example (can affect multiple fit components in multiple categories:
#SysForm_Migr:		Migr[constr=logn,center=1.0,type=yield,comp=SigBSM2H_bb~0.001,comp=SigSM_bb~-0.001]

#################### MODEL FOR CATEGORY = jj:

##### The observable in category jj:
OBS_jj:			m_yy_jj[105,150]
OBSPrint_jj:		M_{#gamma#gamma} [GeV]

##### Non-systematic variables in category jj:
VARS_jj:		n_BkgNonHiggs_jj[10000,0,1000000] p0_BkgNonHiggs[-0.1,-10.0,10.0]

##### Functions, Expressions in category jj:
EXPRS_jj:	 	sum::n_AllProcesses_jj(n_BkgNonHiggs_jj)

##### PDF in category jj:
PDFS_jj:		RooExponential::pdf_BkgNonHiggs_jj(m_yy_jj,((p0_BkgNonHiggs-100.0)/100.0))

##### Complete model in category jj:
MODEL_jj:		SUM::model_jj(n_BkgNonHiggs_jj*pdf_BkgNonHiggs_jj)

#################### MODEL FOR CATEGORY = bj:

##### The observable in category bj:
OBS_bj:			m_yy_bj[105,150]
OBSPrint_bj:		M_{#gamma#gamma} [GeV]

##### Non-systematic variables in category bj:
VARS_bj:		mu_BR_gamgam[1] mu_SigSM[1] mu_ggH[1] mu_VBF[1] mu_WH[1] mu_ZH[1] mu_ttH[1] nPerFb_SigSMggH_bj[0.002327] nPerFb_SigSMVBF_bj[0.00001] nPerFb_SigSMWH_bj[0.001235] nPerFb_SigSMZH_bj[0.009815] nPerFb_SigSMttH_bj[0.02505] nPerFb_SigBSM2H_bj[0.5279] n_BkgNonHiggs_bj[100,0,1000000] muCBNom_SigSM_bj[270.00] sigmaCBNom_SigSM_bj[15.00] alphaCBLo_SigSM_bj[6.07] nCBLo_SigSM_bj[1.77] alphaCBHi_SigSM_bj[0.15] nCBHi_SigSM_bj[8.63] muCBNom_SigBSM2H_bj[300.00] sigmaCBNom_SigBSM2H_bj[3.15] alphaCBLo_SigBSM2H_bj[0.97] nCBLo_SigBSM2H_bj[9.00] alphaCBHi_SigBSM2H_bj[0.96] nCBHi_SigBSM2H_bj[5.00]
# expectation_yield_SigSMggH[1.0] expectation_yield_SigSMVBF[1.0] expectation_yield_SigSMWH[1.0] expectation_yield_SigSMZH[1.0] expectation_yield_SigSMttH[1.0] expectation_yield_SigBSM2H[1.0] 

##### Functions, Expressions in category bj:
EXPRS_bj:	 	prod::expectationCommon(Luminosity,expectation_yield_Common) prod::expectation_SigSMggH_bj(mu_SigSM,mu_BR_gamgam,mu_ggH,expectation_yield_SigSMggH) prod::expectation_SigSMVBF_bj(mu_SigSM,mu_BR_gamgam,mu_VBF,expectation_yield_SigSMVBF) prod::expectation_SigSMWH_bj(mu_SigSM,mu_BR_gamgam,mu_WH,expectation_yield_SigSMWH) prod::expectation_SigSMZH_bj(mu_SigSM,mu_BR_gamgam,mu_ZH,expectation_yield_SigSMZH) prod::expectation_SigSMttH_bj(mu_SigSM,mu_BR_gamgam,mu_ttH,expectation_yield_SigSMttH) prod::expectation_SigBSM2H_bj(mu_SigBSM2H,expectation_yield_SigBSM2H) prod::n_SigSMggH_bj(nPerFb_SigSMggH_bj,expectationCommon,expectation_SigSMggH) prod::n_SigSMVBF_bj(nPerFb_SigSMVBF_bj,expectationCommon,expectation_SigSMVBF) prod::n_SigSMWH_bj(nPerFb_SigSMWH_bj,expectationCommon,expectation_SigSMWH) prod::n_SigSMZH_bj(nPerFb_SigSMZH_bj,expectationCommon,expectation_SigSMZH) prod::n_SigSMttH_bj(nPerFb_SigSMttH_bj,expectationCommon,expectation_SigSMttH) prod::n_SigBSM2H_bj(nPerFb_SigBSM2H_bj,expectationCommon,expectation_SigBSM2H) prod::n_Bias_bj(Luminosity,expectation_yield_Bias_bj) sum::n_AllProcesses_bj(n_BkgNonHiggs_bj,n_SigSMggH_bj,n_SigSMVBF_bj,n_SigSMWH_bj,n_SigSMZH_bj,n_SigSMttH_bj,n_SigBSM2H_bj)

##### PDF in category bj:
PDFS_bj:		RooExponential::pdf_BkgNonHiggs_bj(m_yy_bj,((p0_BkgNonHiggs-100.0)/100.0)) HggTwoSidedCBPdf::pdf_SigSM_bj(m_yy_bj,prod::muCB_SigSM_bj(muCBNom_SigSM_bj,expectation_scale_SigSM_bj),prod::sigmaCB_SigSM_bj(sigmaCBNom_SigSM_bj,expectation_res_SigSM_bj),alphaCBLo_SigSM_bj,nCBLo_SigSM_bj,alphaCBHi_SigSM_bj,nCBHi_SigSM_bj) HggTwoSidedCBPdf::pdf_SigBSM2H_bj(m_yy_bj,prod::muCB_SigBSM2H_bj(muCBNom_SigBSM2H_bj,expectation_scale_SigBSM2H_bj),prod::sigmaCB_SigBSM2H_bj(sigmaCBNom_SigBSM2H_bj,expectation_res_SigBSM2H_bj),alphaCBLo_SigBSM2H_bj,nCBLo_SigBSM2H_bj,alphaCBHi_SigBSM2H_bj,nCBHi_SigBSM2H_bj)

##### Complete model in category bj:
MODEL_bj:		SUM::model_bj(n_BkgNonHiggs_bj*pdf_BkgNonHiggs_bj,n_SigSMggH_bj*pdf_SigSM_bj,n_SigSMVBF_bj*pdf_SigSM_bj,n_SigSMWH_bj*pdf_SigSM_bj,n_SigSMZH_bj*pdf_SigSM_bj,n_SigSMttH_bj*pdf_SigSM_bj,n_SigBSM2H_bj*pdf_SigBSM2H_bj,n_Bias_bj*pdf_SigBSM2H_bj)

#################### MODEL FOR CATEGORY = bb:

##### The observable in category bb:
OBS_bb:			m_yy_bb[200,1000]
OBSPrint_bb:		M_{#gamma#gamma} [GeV]

##### Non-systematic variables in category bb:
VARS_bb:		nPerFb_SigSMggH_bb[0.002327] nPerFb_SigSMVBF_bb[0.00001] nPerFb_SigSMWH_bb[0.001235] nPerFb_SigSMZH_bb[0.009815] nPerFb_SigSMttH_bb[0.02505] nPerFb_SigBSM2H_bb[0.5279] n_BkgNonHiggs_bb[100,0,1000000] muCBNom_SigSM_bb[270.00] sigmaCBNom_SigSM_bb[15.00] alphaCBLo_SigSM_bb[6.07] nCBLo_SigSM_bb[1.77] alphaCBHi_SigSM_bb[0.15] nCBHi_SigSM_bb[8.63] muCBNom_SigBSM2H_bb[300.00] sigmaCBNom_SigBSM2H_bb[3.15] alphaCBLo_SigBSM2H_bb[0.97] nCBLo_SigBSM2H_bb[9.00] alphaCBHi_SigBSM2H_bb[0.96] nCBHi_SigBSM2H_bb[5.00] 

#expectation_yield_SigSMggH_bb[1.0] expectation_yield_SigSMVBF_bb[1.0] expectation_yield_SigSMWH_bb[1.0] expectation_yield_SigSMZH_bb[1.0] expectation_yield_SigSMttH_bb[1.0] expectation_yield_SigBSM2H_bb[1.0] 
#expectation_yield_SigSM_bb[1.0]

##### Functions, Expressions in category bb:
EXPRS_bb:	 	prod::expectation_SigSMggH_bb(mu_SigSM,mu_BR_gamgam,mu_ggH,expectation_yield_SigSMggH) prod::expectation_SigSMVBF_bb(mu_SigSM,mu_BR_gamgam,mu_VBF,expectation_yield_SigSMVBF) prod::expectation_SigSMWH_bb(mu_SigSM,mu_BR_gamgam,mu_WH,expectation_yield_SigSMWH) prod::expectation_SigSMZH_bb(mu_SigSM,mu_BR_gamgam,mu_ZH,expectation_yield_SigSMZH) prod::expectation_SigSMttH_bb(mu_SigSM,mu_BR_gamgam,mu_ttH,expectation_yield_SigSMttH) prod::expectation_SigBSM2H_bb(mu_SigBSM2H,expectation_yield_SigBSM2H) prod::n_SigSMggH_bb(nPerFb_SigSMggH_bb,expectationCommon,expectation_SigSMggH) prod::n_SigSMVBF_bb(nPerFb_SigSMVBF_bb,expectationCommon,expectation_SigSMVBF) prod::n_SigSMWH_bb(nPerFb_SigSMWH_bb,expectationCommon,expectation_SigSMWH) prod::n_SigSMZH_bb(nPerFb_SigSMZH_bb,expectationCommon,expectation_SigSMZH) prod::n_SigSMttH_bb(nPerFb_SigSMttH_bb,expectationCommon,expectation_SigSMttH) prod::n_SigBSM2H_bb(nPerFb_SigBSM2H_bb,expectationCommon,expectation_SigBSM2H) prod::n_Bias_bb(Luminosity,expectation_yield_Bias_bb) sum::n_AllProcesses_bb(n_BkgNonHiggs_bb,n_SigSMggH_bb,n_SigSMVBF_bb,n_SigSMWH_bb,n_SigSMZH_bb,n_SigSMttH_bb,n_SigBSM2H_bb)

##### PDF in category bb:
PDFS_bb:		RooExponential::pdf_BkgNonHiggs_bj(m_yy_bb,((p0_BkgNonHiggs-100.0)/100.0)) HggTwoSidedCBPdf::pdf_SigSM_bb(m_yy_bb,prod::muCB_SigSM_bb(muCBNom_SigSM_bb,expectation_scale_SigSM_bb),prod::sigmaCB_SigSM_bb(sigmaCBNom_SigSM_bb,expectation_res_SigSM_bb),alphaCBLo_SigSM_bb,nCBLo_SigSM_bb,alphaCBHi_SigSM_bb,nCBHi_SigSM_bb) HggTwoSidedCBPdf::pdf_SigBSM2H_bb(m_yy_bb,prod::muCB_SigBSM2H_bb(muCBNom_SigBSM2H_bb,expectation_scale_SigBSM2H_bb),prod::sigmaCB_SigBSM2H_bb(sigmaCBNom_SigBSM2H_bb,expectation_res_SigBSM2H_bb),alphaCBLo_SigBSM2H_bb,nCBLo_SigBSM2H_bb,alphaCBHi_SigBSM2H_bb,nCBHi_SigBSM2H_bb)

##### Complete model in category bb:
MODEL_bb:		SUM::model_bb(n_BkgNonHiggs_bb*pdf_BkgNonHiggs_bb,n_SigSMggH_bb*pdf_SigSM_bb,n_SigSMVBF_bb*pdf_SigSM_bb,n_SigSMWH_bb*pdf_SigSM_bb,n_SigSMZH_bb*pdf_SigSM_bb,n_SigSMttH_bb*pdf_SigSM_bb,n_SigBSM2H_bb*pdf_SigBSM2H_bb,n_Bias_bb*pdf_SigBSM2H_bb)

################################################################################
# General directory structures:

# Location of global input files:
MasterInput: 		/afs/cern.ch/work/a/ahard/files_Hbbgg/GlobalInputs

# Location of output directory:
MasterOutput:		/afs/cern.ch/work/a/ahard/files_Hbbgg/FullAnalysis
  
# Location of this software package:
PackageLocation:	/afs/cern.ch/user/a/ahard/analysis/56_Hbbyy

################################################################################
# Input MxAOD locations:

MxAODDirectory: 	/afs/cern.ch/user/a/ahard/work_directory/files_Hbbgg/GlobalInputs/inputs_13TeV/MxAODs

################################################################################
# Settings for remote job submission:

# Holding location of cluster job files:
ClusterFileLocation:	/afs/cern.ch/work/a/ahard/jobfiles

exeWorkspace: 		DHWorkspaceWrapper
jobScriptWorkspace: 	scripts/jobFileWorkspace.sh

exeTestStat: 		DHTestStatWrapper
jobScriptTestStat: 	scripts/jobFileTestStat.sh

exeMuLimit: 		DHMuLimit
jobScriptMuLimit: 	scripts/jobFileMuLimit.sh

exePseudoExp: 		DHPseudoExp
jobScriptPseudoExp: 	scripts/jobFilePseudoExp.sh

# End of configuration.
